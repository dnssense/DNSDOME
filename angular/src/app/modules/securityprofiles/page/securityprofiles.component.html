<div class="rk-base-card">
  <div class="card-item">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12 p-0">
          <h5 class="page-title">{{'SecurityProfiles'|translate}}</h5>
        </div>
      </div>

      <rk-modal #profileModal>
        <rk-modal-header>
          <rk-modal-header-title>
            <h5>{{'SecurityProfile'|translate}}</h5>
          </rk-modal-header-title>

          <rk-modal-header-close (click)="profileModal.toggle()"></rk-modal-header-close>
        </rk-modal-header>

        <rk-modal-body>

          <app-profile-wizard #profileWizard [selectedAgent]="selectedAgent" [currentStep]="1" [saveMode]="saveMode"
            (saveEmitter)="saveSuccess()"></app-profile-wizard>

        </rk-modal-body>

        <rk-modal-footer *ngIf="saveMode !== 'NotEditable'">
          <button class="btn btn-small w-100 mr-2"
            [ngClass]="{'disabled': saveMode === 'NewProfile' && selectedAgent.rootProfile?.name?.length < 2}"
            (click)="saveProfile()">{{'Save'|translate}}</button>
          <button class="btn btn-small w-100" (click)="profileModal.toggle()">{{'Close'|translate}}</button>
        </rk-modal-footer>
      </rk-modal>

      <div class="row">
        <div class="col-12 p-0 mt-3">
          <rk-table-container class="m-0">
            <div class="rk-table-container-header">
              <div class="top-content justify-content-between">
                <div class="d-flex align-items-center">
                  <div class="inf mr-4">
                    <span class="text-primary">{{ securityProfiles?.length }}</span> {{'QueriesListed'|translate}}
                  </div>

                  <div class="search ml-5">
                    <div class="rk-autocomplete-container" style="width: 220px;">
                      <input type="text" placeholder="Search" [(ngModel)]="searchKey" class="rk-input rk-autocomplete">
                      <i-feather class="search-icon" name="search"></i-feather>
                    </div>
                  </div>
                </div>

                <button class="btn btn-small btn-icon" (click)="newProfile()">
                  <i-feather name="plus"></i-feather>
                  {{'CreateNewProfile'|translate}}
                </button>
              </div>
            </div>

            <rk-table [showPagination]="false">
              <ng-template #header>
                <tr>
                  <th style="width: 32px;">#</th>
                  <th>{{'ProfileName'|translate}}</th>
                  <th>{{'MemberCount'|translate}}</th>
                  <th colspan="3">{{'Operation'|translate}}</th>
                </tr>
              </ng-template>

              <ng-template #body>
                <tr *ngFor="let profile of securityProfiles |Â filter: searchKey: 'name'; let index = index">
                  <td style="width: 32px;">{{ index + 1 }}</td>
                  <td>{{ profile.name }}</td>
                  <td>{{ profile.numberOfUsage }}</td>
                  <td class="text-center" style="width: 60px;">
                    <button class="btn btn-link btn-icon p-0 hover-gray" (click)="cloneProfile(profile)">
                      <i-feather name="copy" class="mr-0"></i-feather>
                    </button>
                  </td>
                  <td class="text-center" style="width: 60px;">
                    <button class="btn btn-link btn-icon p-0 hover-gray"
                      *ngIf="profile.isSystem" (click)="viewProfile(profile)">
                      <i-feather name="eye" class="mr-0"></i-feather>
                    </button>

                    <button class="btn btn-link btn-icon p-0 hover-gray"
                      *ngIf="!profile.isSystem" (click)="editProfile(profile)">
                      <i-feather name="edit-3" class="mr-0"></i-feather>
                    </button>
                  </td>
                  <td class="text-center" style="width: 60px;">
                    <button class="btn btn-link btn-icon p-0 hover-gray" (click)="deleteProfile(profile.id)">
                      <i-feather name="trash-2" class="mr-0"></i-feather>
                    </button>
                  </td>
                </tr>
              </ng-template>
            </rk-table>
          </rk-table-container>
        </div>
      </div>
    </div>
  </div>
</div>